B.J. Hall brought this legal malpractice action against White, Getgey, Meyer & Co., LPA (“White/Getgey”), the law firm that represented him in a suit for disability benefits against Hartford Life and Accident Insurance Company (“Hartford”).   Hall alleged that the firm's failure to supplement responses to interrogatories led to the exclusion of his medical expert witnesses at trial and forced him to settle with Hartford for a nominal amount.   This case went to trial, and the jury returned a verdict in Hall's favor and awarded him $675,000 in damages.   When the magistrate judge who presided over the trial entered judgment on the verdict, she found that White/Getgey was entitled to a settlement credit equal to 40% of the damages award on account of Hall's release of his first attorney in the underlying suit from malpractice liability in exchange for the attorney's release of Hall from any claim for compensation under a 40% contingent-fee agreement.   The judge reduced Hall's award accordingly.   Both parties appeal.   Hall challenges the reduction of his damages award;  White/Getgey contends that an offset provision of the Hartford policy required the magistrate judge to reduce the award even further.   We modify the damages award and affirm the magistrate judge's final judgment as modified.
I. BACKGROUND
From July 5, 1989, to May 18, 1990, B.J. Hall was the executive vice president and chief operating officer of Incarnate Word Health Services (“Incarnate Word”), a company that operated hospitals in Texas and Missouri.   As an employee of Incarnate Word, Hall was covered by a group disability policy issued by Hartford.   Under that policy, Hall was eligible for benefits if he became “totally disabled” while employed at Incarnate Word.
On May 7, 1990, Hall was injured in an automobile accident;  in particular, he suffered a whiplash injury and later complained of weakness in his extremities, loss of balance, and fatigue.1  In the days following the accident, Hall attended one staff meeting but did not otherwise return to work.   On May 11, 1990, Incarnate Word notified Hall that his employment would be terminated effective May 18, 1990.   The termination was apparently unrelated to Hall's physical condition after the accident.
During 1990 and 1991, Hall consulted two physicians, and both indicated that he had become totally disabled on May 7, 1990, as a result of the automobile accident.   In April 1991, Hall submitted a claim for disability benefits under the Hartford policy, but Hartford denied the claim.
In response to this denial, Hall retained Houston attorney Harvill E. Weller, Jr., on a 40% contingent-fee basis.   Weller filed suit against Hartford on Hall's behalf in Bexar County, Texas.   When Hall disagreed with certain recommendations that Weller made concerning the case, their attorney-client relationship began to suffer.   In February 1995, just a few months before the trial date, Hall and Weller decided to terminate their relationship.   Hall replaced Weller with White/Getgey, a firm based in Cleveland, Ohio. Hall chose White/Getgey because the firm had previously represented him in Ohio in a similar lawsuit against New England Mutual Life Insurance Company.   On April 27, 1995, Hall and Weller executed a “Mutual Release and Agreement to Terminate Legal Relationship.”   Under the terms of that agreement, Hall reimbursed Weller for his out-of-pocket expenses and released him from malpractice liability;  Weller, in turn, released Hall from any claim for attorney's fees.
The suit against Hartford went to trial on June 5, 1995.   During a hearing on unresolved pretrial matters, the state district judge granted Hartford's motion to exclude Hall's medical expert witnesses because his attorneys had not supplemented his responses to interrogatories relating to those witnesses.   Without medical experts, Hall had no possibility of winning his case, so he settled with Hartford for $20,000.2
Hall later filed this action against White/Getgey in Texas state court, alleging that the firm's failure to supplement discovery responses constituted legal malpractice.   White/Getgey removed the case to federal court on the basis of diversity jurisdiction and then filed a third-party complaint for contribution against Weller.   Weller filed a motion for summary judgment, contending that (1) he was released from all liability for potential malpractice claims in his April 27, 1995 agreement with Hall;  (2) Texas law provides that no defendant has a right of contribution against a “settling person”;  and (3) by virtue of the release, he was a “settling person” as a matter of law.   The district court agreed that Weller was a “settling person” under the relevant Texas statute because he gave up his attorney's fees in exchange for Hall's releasing him from malpractice liability.   The court therefore granted Weller's motion for summary judgment and dismissed him from the case.
After dismissing Weller from the case, and upon the parties' consent, the district court assigned this case to a magistrate judge, who granted White/Getgey's motion for summary judgment and dismissed Hall's complaint.3  The magistrate judge concluded that the underlying suit was without merit because Hall could not show that he was “totally disabled” as that term was defined in the Hartford policy.   Hall appealed to this court, and we reversed and remanded, finding that he had presented sufficient evidence of his total disability to withstand summary judgment.4
On remand, the parties filed cross-motions for summary judgment on an affirmative defense of offset that White/Getgey had pleaded in its first amended answer.   That defense was based on a provision of the Hartford policy that permitted Hartford to reduce the benefits it owed to Hall by the amount of income benefits he had received from other sources as a result of his disability.5  Reasoning that a favorable damages award against Hartford in the underlying suit would have been offset by Hall's “other income benefits,” White/Getgey argued that Hall's recovery in this action was likewise limited.6  But Hartford never pleaded its offset right as an affirmative defense in the underlying suit.   Hall therefore contended that Hartford waived the defense and that, as a consequence, White/Getgey could not raise it in a malpractice action.   The magistrate judge agreed that Hartford's failure to plead offset amounted to a waiver of that defense under Texas law and further found that “[i]n this case, Hall's measure of damages is the amount he would have received from the jury if his White/Getgey lawyers had properly prosecuted his claim, considering all the applicable affirmative defenses Hartford pleaded in the underlying lawsuit and nothing more.”   In accordance with this finding, the magistrate judge entered an order granting Hall's cross-motion for partial summary judgment and striking White/Getgey's affirmative defense of offset.
This case went to trial in August 2001.   The jury returned a verdict in Hall's favor in the amount of $675,000 and determined that White/Getgey was responsible for 51% of the negligence that resulted in Hall's injuries and that Weller was responsible for the remaining 49%.7  Soon after the trial, the magistrate judge requested briefings from the parties to assist her in entering judgment on the verdict.   White/Getgey contended in its brief, as it had throughout this action, that it was entitled to a settlement credit under § 33.012(b) of the Texas Civil Practice and Remedies Code equal to 40% of the damages award.   Its theory was that Hall had settled his malpractice claim against Weller for that amount when they executed the mutual release.   In her “Order on Entry of Judgment,” the magistrate judge agreed that the mutual release was a “settlement” for purposes of § 33.012(b) and that White/Getgey was entitled to a credit equal to the dollar amount of the settlement.   The judge also agreed with White/Getgey that the “dollar amount” of the settlement was 40% of Hall's damages award ($270,000) and reduced the award accordingly.
Both parties filed timely notices of appeal.
II. ANALYSIS
 We face two issues.   First, Hall contends that the mutual release was not a “settlement” and that, even if it was, the magistrate judge misapplied § 33.012(b) of the Texas Civil Practice and Remedies Code. Second, White/Getgey challenges the magistrate judge's order striking its affirmative defense of offset.   The firm contends that Texas law does not limit a malpractice defendant to the defenses actually raised in the underlying suit.8  Because both of these issues concern the magistrate judge's application of Texas law, our review is de novo.9
A. Settlement Credit
Section 33.012(b) of the Texas Civil Practice and Remedies Code provides that if a claimant in a tort action has settled with a person who bears some responsibility for his injuries, the trial court must reduce the claimant's damages award to account for the settlement:
If the claimant has settled with one or more persons, the court shall further reduce the amount of damages to be recovered by the claimant with respect to a cause of action by a credit equal to one of the following, as elected in accordance with Section 33.014:
(1) the sum of the dollar amounts of all settlements;  or
(2) a dollar amount equal to the sum of the following percentages of damages found by the trier of fact:
(A) 5 percent of those damages up to $200,000;
(B) 10 percent of those damages from $200,001 to $400,000;
(C) 15 percent of those damages from $400,001 to $500,000;  and
(D) 20 percent of those damages greater than $500,000.10
Although Chapter 33 of Civil Practice and Remedies Code contains no definition of the term “settlement,” § 33.011(5) provides that a “settling person” is “a person who at the time of submission has paid or promised to pay money or anything of monetary value to a claimant at any time in consideration of potential liability․”11  Tracking this language in part, the Texas Supreme Court has held that “ ‘settlement,’ as used in the Comparative Responsibility Law, means money or anything of value paid or promised to a claimant in consideration of potential liability.”12
 A defendant seeking a settlement credit has the right to choose between the two methods of calculation provided for in § 33.012(b)-dollar-for-dollar or sliding scale.   To obtain a dollar-for-dollar credit, the defendant must file a written election of that option before the case is submitted to the trier of fact.13  If he has made such an election, the defendant must then prove the settlement credit amount.14  He can meet this burden by placing the settlement agreement or some evidence of the settlement amount in the record.15  If the defendant fails to prove the settlement credit amount, he is not entitled to a dollar-for-dollar credit, and the trial court is limited to using the sliding scale method to reduce the damages award.16
 Here, we must first determine whether the mutual release executed by Hall and Weller on April 27, 1995, was a settlement.   The answer is yes if Weller gave anything of value to Hall in consideration of potential liability.17  As we discuss more fully below, Weller had a claim against Hall for attorney's fees upon the termination of their contingent-fee agreement, and the record indicates that Hall pursued the release to avoid having to compensate both Weller and White/Getgey for their services.18  When Weller executed the release, he gave up his claim for attorney's fees in exchange for Hall's reimbursing him $21,027 in expenses and releasing him from all liability arising out of the representation.   Because Weller's relinquishment of his claim was valuable to Hall and was done, at least in part, in consideration of potential malpractice liability, the magistrate judge correctly held that the mutual release was a settlement.
Because there was a settlement, Texas law required the magistrate judge to reduce Hall's judgment.19  The only question remaining concerns the proper amount of the reduction.   In accordance with § 33.014 of the Civil Practice and Remedies Code, White/Getgey filed a written election seeking a dollar-for-dollar settlement credit before this case was submitted to the jury.   Although White/Getgey acknowledged that, in the typical case, the settlement to be credited against the judgment is expressed in a fixed dollar amount, it sought a credit equal to 40% of Hall's recovery.   It explained that Weller was entitled to that same 40% under his contingent-fee contract with Hall, but that Weller gave up that interest when he signed the release.   White/Getgey further explained that “[a]lthough the Weller contract was expressed in a percentage, there is a dollar figure that can be placed on the value of the Weller settlement once the jury reaches its verdict.”   The magistrate judge agreed that the dollar-for-dollar value of Hall's settlement with Weller was 40% of the damages awarded by the jury and reduced Hall's recovery by that measure.
 We find that the 40% reduction was improper.  “Under Texas law, whether and how to compensate an attorney when a contingent fee contract is prematurely terminated depends on whether the attorney was discharged, withdrew with the consent of the client, or withdrew voluntarily without consent.”20  The attorney discharged without cause can recover on the contingent-fee contract or in quantum meruit, but if the client proves good cause for the discharge, the attorney is limited to recovery in quantum meruit for services rendered up to the time of the discharge.21  “When both parties assent to the contract's abandonment, the attorney can recover for the reasonable value of the services rendered.”22  And when the attorney abandons the contract before completion without good cause, he forfeits his right to compensation under the contract;23  if, however, he has good cause for withdrawing without the client's consent, the attorney is probably entitled to compensation, but the proper measure of that compensation is unclear.24
 In this case, the record supports neither a finding that Weller was discharged nor a finding that he withdrew without Hall's consent.   Every indication, instead, is that Hall and Weller agreed to terminate their attorney-client relationship in February 1995 and then began negotiating the terms of the mutual release.   Because both parties assented to the termination of the representation contract, Weller was entitled, under Texas law, to recover only the reasonable value of his services from Hall.25  And it was his claim for that reasonable value that Weller released in exchange for Hall's reimbursing his expenses and releasing him from malpractice liability.   Therefore, the magistrate judge erred in finding that the value of the settlement was 40% of Hall's recovery.
Although White/Getgey placed Hall and Weller's contingent-fee agreement and their mutual release in the record, it never introduced evidence concerning the reasonable value of Weller's services.   Because it failed to introduce such evidence, the firm did not satisfy its burden of proving the settlement credit amount.   It follows that White/Getgey was not entitled to a dollar-for-dollar credit and that the magistrate judge should have used the sliding scale method of § 33.012(b)(2) to reduce the damages award.26  Applying that method of calculation in the light of the damages found by the jury in this case yields a settlement credit of $80,000.27  We modify Hall's damages award so that it reflects a reduction by this proper amount.
B. Offset
 We now consider whether the magistrate judge's ruling on the offset issue was inconsistent with Texas legal malpractice law.   In Texas, a legal malpractice action sounds in tort and is governed by negligence principles.28  To recover on a claim for legal malpractice, the plaintiff must establish that (1) the attorney owed him a duty, (2) the attorney breached that duty, (3) the breach proximately caused injury to the plaintiff, and (4) damages resulted.29  If the claim concerns the attorney's handling of a litigated matter, proving causation is particularly challenging for the plaintiff, who must show that he would have prevailed in the underlying suit but for the attorney's negligence and that he would have been able to collect some or all of a favorable judgment.30  This causation burden is commonly referred to as the “suit within a suit” requirement.31
In an effort to negate the causation element of Hall's malpractice claim, White/Getgey argued that Hartford's right to offset the benefits it owed Hall against the “other income benefits” he had received as a result of his disability would have severely limited his recovery in the underlying suit.   The magistrate judge found, however, that Texas law requires an insurer to specifically plead offset as an affirmative defense and that Hartford waived the defense by failing to plead it in the underlying suit.32  White/Getgey does not challenge these findings in this appeal.   It has therefore abandoned any contention that Hartford could have raised the defense of offset in the underlying suit.33  The firm argues instead that Hartford's waiver of the defense has no bearing on whether it can raise it in this action.
In support of this argument, White/Getgey relies exclusively on the opinion of the Texas Fourteenth Court of Appeals in Swinehart v. Stubbeman, McRae, Sealy, Laughlin & Browder, Inc., a malpractice case in which the court held that the defendant attorneys could raise an affirmative defense that had not been pleaded in the underlying suit.34  In that case, however, the plaintiff never raised a claim in the underlying action against which the defendant would have been required to plead the affirmative defense at issue.35  Thus, as the magistrate judge correctly recognized, this case is distinguishable from Swinehart because Hall asserted a claim in the underlying action against which Hartford was required to plead offset as an affirmative defense.   Despite this distinction, White/Getgey seizes on the Swinehart court's statement that “[a]n attorney's defense to a legal malpractice claim should not rest on the underlying defendant's handling of its own defense.”36  Although this broad statement will hold true in some cases, White/Getgey contends that we must apply it as an absolute rule of Texas law and reverse the magistrate judge's ruling that the firm could not raise the defense of offset because Hartford waived it in the underlying action.   We disagree.
 “Our goal, sitting as an Erie court, is to rule the way the Texas Supreme Court would rule on the issue presented.”37  According to that court's seminal opinion in Cosgrove v. Grimes, to prove a “suit within a suit,” a malpractice plaintiff must establish the amount of damages he would have recovered and collected if his attorney had properly prosecuted the underlying suit.38  In our view, this description of the plaintiff's burden admits of no hard and fast rule prohibiting him from showing that his adversary's waiver of an affirmative defense in the underlying suit would have allowed him to recover and collect a larger amount of damages than he could have absent the waiver.   That parties sometimes reap benefits as a matter of law even though they are not entitled to those benefits as a matter of equity is a reality of the adversary system and the procedural rules that govern it.   If a malpractice plaintiff proves that he would have benefitted from his adversary's failure to comply with a procedural rule, we are aware of no principle of Texas law that would prevent the trier of fact from considering that benefit in determining whether the attorney's breach of the applicable standard of care caused harm to the plaintiff.   We therefore predict that the Texas Supreme Court would hold that when a malpractice plaintiff proves both the underlying defendant's waiver of an affirmative defense and the effect of that waiver on the amount of damages he could have recovered and collected if the underlying suit had been properly prosecuted, the malpractice defendant cannot rely on that defense to negate the causation element of the plaintiff's claim.
 In this case, it is undisputed that Hartford waived its affirmative defense of offset in the underlying suit and that Hall was in a position to benefit from the waiver.   Through its negligence, White/Getgey deprived Hall of that benefit.   If the firm had supplemented Hall's discovery responses, his doctors would have testified to his total disability, and he would have been entitled to judgment against Hartford.   The jury's verdict in this case establishes as much.   And Hartford's waiver meant that a favorable damages award in the underlying suit would not have been offset by the amount of Hall's other disability benefits.   Because Hall proved both the waiver and the effect of that waiver on the amount of damages he could have recovered and collected if White/Getgey had properly prosecuted the underlying suit, we conclude, in accordance with our Erie guess, that White/Getgey could not rely on the offset provision of the Hartford policy to negate the causation element of Hall's malpractice claim.   Thus, we find no error in the magistrate judge's ruling on this issue.
III. CONCLUSION
For the foregoing reasons, we affirm the magistrate judge's pretrial ruling on the offset issue, modify the damages award so that it reflects the proper settlement credit of $80,000, and affirm the final judgment as modified.   This case is remanded for entry of an amended judgment in Hall's favor in the amount of $595,000.
AFFIRMED AS MODIFIED;  REMANDED WITH INSTRUCTIONS.
FOOTNOTES
1.   Hall had a preexisting condition-“post-polio syndrome.”   As its name implies, post-polio syndrome affects polio survivors, usually many years after their initial bout with the disease.   The condition involves slow but progressive weakening of the muscles.   Although some of the impairments that Hall experienced after the accident are symptoms of post-polio syndrome, Hall asserts that a sudden trauma such as whiplash can trigger or exacerbate those symptoms.
2.   Hall had originally sought over $1 million in disability benefits under the Hartford policy.
3.   See 28 U.S.C. § 636(c)(1) (“Upon the consent of the parties, a full-time United States magistrate ․ may conduct any or all proceedings in a jury or nonjury civil matter and order the entry of judgment in the case, when specifically designated to exercise such jurisdiction by the district court or court he serves.”).
4.   Hall v. White, Getgey, Meyer Co., 250 F.3d 743 (5th Cir.2001) (unpublished).
5.   Hartford specified those other sources in the policy's lengthy definition of the term “other income benefits.”
6.   According to White/Getgey, those “other income benefits” include Hall's social security disability benefits, disability benefits he recovered on a policy issued through the American Institute of Certified Public Accountants, benefits he received from New England Mutual Life Insurance Company, and his settlement with Hartford in the underlying action.   Those benefits exceed $1 million.
7.   Under Texas law, a defendant is jointly and severally liable for all recoverable damages if the percentage of responsibility attributed to him is greater than 50%.   See Tex. Civ. Prac. & Rem. Code § 33.013(b).
8.   Hall argues in his brief that White/Getgey waived its right to appeal on this issue because it did not mention the magistrate judge's order striking the defense in its notice of appeal.   This argument is meritless, for an appeal from the final judgment draws into question all prior nonfinal orders and all rulings that produced the judgment.   See 20 James Wm. Moore et al., Moore's Federal Practice § 303.21[3][c][iii] (3d ed.).  “Thus, a failure of the notice of appeal to specifically refer to a preliminary or interlocutory order does not prevent the review of that order on appeal.”  Id. (citing New York Life I